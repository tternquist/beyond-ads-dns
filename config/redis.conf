# Redis configuration for beyond-ads-dns
# This file is mounted into the Redis container in docker-compose.yml

# Memory management
maxmemory 512mb
maxmemory-policy allkeys-lru

# Persistence
# Save snapshot every 60 seconds if at least 1000 keys changed
save 60 1000

# Enable AOF (Append Only File) for durability
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec

# Recommended for DNS caching:
# - allkeys-lru: Evict least recently used keys (recommended)
# - allkeys-lfu: Evict least frequently used keys
#
# Other policies available:
# - allkeys-random: Evict random keys
# - volatile-lru: Evict LRU keys with TTL set (not ideal for DNS cache)
# - volatile-lfu: Evict LFU keys with TTL set (not ideal for DNS cache)
# - volatile-random: Evict random keys with TTL set (not ideal for DNS cache)
# - volatile-ttl: Evict keys with shortest TTL (not ideal for DNS cache)
# - noeviction: Return errors when memory limit reached (not recommended)
#
# Note: DNS cache entries don't have Redis TTLs, so volatile-* policies
# will only evict metadata (hit counters, locks). Use allkeys-* policies
# to ensure cache entries can be evicted under memory pressure.
